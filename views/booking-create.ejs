<html>

<head>
  <!-- Standard Meta -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
  <link href="//cdn.rawgit.com/mdehoog/Semantic-UI-Calendar/76959c6f7d33a527b49be76789e984a0a407350b/dist/calendar.min.css"
    rel="stylesheet" type="text/css" />

  <!-- Special version of Bootstrap that only affects content wrapped in .bootstrap-iso -->
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.13/semantic.min.css" />
  <script src="//code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="//cdn.rawgit.com/mdehoog/Semantic-UI-Calendar/76959c6f7d33a527b49be76789e984a0a407350b/dist/calendar.min.js"></script>

  <script src="//cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.13/semantic.min.js"></script>

  <script>
    $(document).ready(function () {
      $('.ui.form').form({
        fields: {
          closeDate: {
            identifier: 'phone',
            rules: [{
              type: 'empty',
              prompt: '請選擇結案日期'
            }]
          },
          warranty: {
            identifier: 'warranty',
            rules: [{
              type: 'number',
              prompt: '請輸入數字'
            }]
          },
        }
      });
      $('#datePicker').calendar(
        { type: 'date' }
      );
      $('#addMainProduct').click(function () {
        let e = $(`<%- include('partials/products', {
          products: mainProducts, quality: 'Main'
        }); %>`)
        e.find('.ui.button').click(function(){
          $(this).parent().parent().remove();
        });
        $('#mainProductList').append(e);
      });
      $('#addMinorProduct').click(function () {
        let e = $(`<%- include('partials/products', {
          products: minorProducts, quality: 'Minor'
        }); %>`)
        e.find('.ui.button').click(function(){
          $(this).parent().parent().remove();
        });
        $('#minorProductList').append(e);
      });
    })
  </script>
  <style>
    #title {
      margin-top: 10px;
      margin-bottom: 10px;
      text-align: center;
    }

    #closeDate {
      width: auto;
    }

    #removeMainProduct .remove.icon,
    #removeMinorProduct .remove.icon,
    #addMainProduct .add.icon,
    #addMinorProduct .add.icon {
      margin: 0px;
    }
  </style>
</head>

<body>
  <div class="ui container">
    <h3 id="title">
      申請報備資料填寫頁面
    </h3>

    <table class="ui unstackable very basic small table">
      <tbody>
        <tr>
          <td class="collapsing"> 申請編號：B106390088-N088V</td>
          <td>申請日期：<%= currentDate%></td>
        </tr>
        <tr>
          <td>經銷商：<%= user.company.name %></td>
          <td>業務：<%= user.name %></td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="ui section divider"></div>

  <div class="ui container">
    <form class="ui form" method="post" action="/booking/create" />
    <input type="hidden" name="userId" value="<%= user.objectId %>">
    <input type="hidden" name="lineId" value="<%= user.lineId %>">
    <div class="inline fields">
      <div class="two wide field">
        <label>產品</label>
      </div>
      <div class="field">
        <input name="productCategory" placeholder="<%= productCategory %>" value="<%= productCategory %>" readonly="" tabindex="-1">
      </div>
    </div>
    <div class="inline fields">
      <div class="two wide field">
        <label>預計結案日</label>
      </div>
      <div class="four wide field">
        <!-- <input type="text" name="closeDate" placeholder="YYYY/MM/DD"> -->
        <div class="ui calendar" id="datePicker">
          <div class="ui input left icon">
            <i class="calendar icon"></i>
            <input type="text" placeholder="Date/Time" name="closeDate" id="closeDate">
          </div>
        </div>

      </div>
    </div>
    <div class="ui form" id="mainProductList">
        <%- 
          include('partials/products', {
            products: mainProducts,
            isTitle: true,
            title: '主系列規格及數量',
            quality: 'Main',
          });
        %>
    </div>

    <div class="ui form" id="minorProductList">
        <% if (minorProducts.length) { %>
          <%- 
            include('partials/products', {
              products: minorProducts,
              isTitle: true,
              title: '配件列規格及數量',
              quality: 'Minor',
            });
          %>
        <% } %>
    </div>
    <div class="inline fields">
      <div class="two wide field">
        <label>保固期間（年）</label>
      </div>
      <div class="field">
        <select class="ui fluid search dropdown" name="renewal">
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
        </select>
      </div>
    </div>
    <button class="ui primary button" type="submit">確認</button>
    <button class="ui clear button">清除重填</button>
    <div class="ui error message"></div>
    </form>
  </div>
</body>

</html>